<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agente Criador</title>
    <style>
        :root {
            --primary-color: #4a6fa5;
            --secondary-color: #166088;
            --accent-color: #4cb5f5;
            --light-color: #f8f9fa;
            --dark-color: #343a40;
            --success-color: #28a745;
            --danger-color: #dc3545;
            --warning-color: #ffc107;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7f9;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .description {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .card {
            background: white;
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
        }
        
        .card-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: var(--secondary-color);
            border-bottom: 2px solid var(--accent-color);
            padding-bottom: 10px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        input[type="text"],
        input[type="password"],
        input[type="file"],
        textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
        }
        
        textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        .required::after {
            content: " *";
            color: var(--danger-color);
        }
        
        .btn {
            display: inline-block;
            padding: 12px 24px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: background-color 0.3s;
        }
        
        .btn:hover {
            background-color: var(--secondary-color);
        }
        
        .btn-success {
            background-color: var(--success-color);
        }
        
        .btn-success:hover {
            background-color: #218838;
        }
        
        .btn-warning {
            background-color: var(--warning-color);
            color: var(--dark-color);
        }
        
        .btn-warning:hover {
            background-color: #e0a800;
        }
        
        .btn-danger {
            background-color: var(--danger-color);
        }
        
        .btn-danger:hover {
            background-color: #c82333;
        }
        
        .btn:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
        }
        
        .chat-container {
            border: 1px solid #ddd;
            border-radius: 8px;
            height: 400px;
            overflow-y: auto;
            padding: 15px;
            margin-bottom: 15px;
            background-color: #f9f9f9;
        }
        
        .message {
            margin-bottom: 15px;
            padding: 10px 15px;
            border-radius: 18px;
            max-width: 80%;
            position: relative;
        }
        
        .user-message {
            background-color: var(--accent-color);
            color: white;
            margin-left: auto;
            border-bottom-right-radius: 4px;
        }
        
        .ai-message {
            background-color: #e9e9e9;
            margin-right: auto;
            border-bottom-left-radius: 4px;
        }
        
        .system-message {
            background-color: #f8f9fa;
            margin: 0 auto;
            text-align: center;
            font-style: italic;
            border-radius: 8px;
            max-width: 90%;
        }
        
        .message-sender {
            font-weight: bold;
            font-size: 0.85rem;
            margin-bottom: 5px;
        }
        
        .test-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .hidden {
            display: none;
        }
        
        .alert {
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid transparent;
            border-radius: 4px;
        }
        
        .alert-success {
            color: #155724;
            background-color: #d4edda;
            border-color: #c3e6cb;
        }
        
        .alert-danger {
            color: #721c24;
            background-color: #f8d7da;
            border-color: #f5c6cb;
        }
        
        .alert-info {
            color: #0c5460;
            background-color: #d1ecf1;
            border-color: #bee5eb;
        }
        
        .flex-row {
            display: flex;
            gap: 15px;
        }
        
        .flex-row > div {
            flex: 1;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: #6c757d;
            font-size: 0.9rem;
        }
        
        .extracted-text {
            margin-top: 15px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 4px;
            border-left: 4px solid var(--accent-color);
            max-height: 200px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
        
        .webhook-url {
            margin-top: 20px;
            padding: 15px;
            background-color: #e9ecef;
            border-radius: 8px;
            border-left: 4px solid var(--success-color);
        }
        
        .copy-btn {
            margin-left: 10px;
            padding: 5px 10px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .progress-container {
            margin: 15px 0;
            background-color: #f8f9fa;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 20px;
            background-color: var(--success-color);
            text-align: center;
            line-height: 20px;
            color: white;
            transition: width 0.3s;
        }
        
        .typing-indicator {
            display: inline-block;
            background-color: #e9e9e9;
            padding: 10px 15px;
            border-radius: 18px;
            border-bottom-left-radius: 4px;
            margin-bottom: 15px;
        }
        
        .typing-dot {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #777;
            margin: 0 3px;
            animation: typingAnimation 1.4s infinite ease-in-out;
        }
        
        .typing-dot:nth-child(1) { animation-delay: 0s; }
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }
        
        @keyframes typingAnimation {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-5px); }
        }
        
        @media (max-width: 768px) {
            .flex-row, .test-controls {
                flex-direction: column;
            }
        }
    </style>
    <!-- Biblioteca Mammoth.js para extrair texto de DOCX -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.4.17/mammoth.browser.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>Agente Criador</h1>
            <p class="description">Crie e teste agentes de IA com base em briefings e prompts personalizados</p>
        </header>
        
        <div class="card">
            <h2 class="card-title">Configuração do Agente</h2>
            
            <div id="alert-area"></div>
            
            <div class="form-group">
                <label for="briefing">Briefing (arquivo DOCX - opcional)</label>
                <input type="file" id="briefing" accept=".docx">
                <small>Envie um documento DOCX contendo as instruções para o agente</small>
                <div id="extracted-text-container" class="hidden">
                    <h4>Texto extraído:</h4>
                    <div id="extracted-text" class="extracted-text"></div>
                </div>
            </div>
            
            <div class="form-group">
                <label for="token" class="required">Token</label>
                <input type="text" id="token" placeholder="Insira o token de acesso">
                <small>Token necessário para acessar as APIs do agente</small>
            </div>
            
            <div class="form-group">
                <label for="prompt">Prompt Complementar (opcional)</label>
                <textarea id="prompt" placeholder="Insira instruções adicionais para o agente"></textarea>
                <small>Instruções extras que complementam o briefing principal</small>
            </div>
            
            <div class="form-group">
                <label for="password" class="required">Senha para Download</label>
                <input type="password" id="password" placeholder="Insira a senha para download">
                <small>Senha necessária para baixar o agente</small>
            </div>
            
            <div class="test-controls">
                <button id="generate-btn" class="btn">Gerar Prompt</button>
                <button id="test-btn" class="btn btn-warning" disabled>Testar Agente</button>
                <button id="download-btn" class="btn btn-success" disabled>Baixar Agente</button>
            </div>
        </div>
        
        <div class="card">
            <h2 class="card-title">Teste do Agente</h2>
            
            <div id="auto-test-controls" class="hidden">
                <button id="start-auto-test-btn" class="btn">Iniciar Teste Automático (10 perguntas)</button>
                <button id="stop-auto-test-btn" class="btn btn-danger" style="display: none;">Parar Teste</button>
                
                <div id="progress-container" class="progress-container hidden">
                    <div id="progress-bar" class="progress-bar" style="width: 0%;">0%</div>
                </div>
            </div>
            
            <div id="chat-container" class="chat-container hidden">
                <!-- As mensagens do chat serão inseridas aqui -->
            </div>
        </div>
        
        <div id="download-success" class="card hidden">
            <h2 class="card-title">Agente Criado com Sucesso!</h2>
            
            <div class="webhook-url">
                <p><strong>URL do Webhook para integração:</strong></p>
                <div class="flex-row">
                    <input type="text" id="webhook-url" readonly>
                    <button class="copy-btn" onclick="copyWebhookUrl('webhook-url')">Copiar</button>
                </div>
            </div>
            
            <div class="webhook-url" style="margin-top: 15px;">
                <p><strong>URL do Webhook para BI:</strong></p>
                <div class="flex-row">
                    <input type="text" id="webhook-bi-url" readonly>
                    <button class="copy-btn" onclick="copyWebhookUrl('webhook-bi-url')">Copiar</button>
                </div>
            </div>
        </div>
        
        <footer>
            <p>Agente Criador &copy; 2023 - Todos os direitos reservados</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Elementos do DOM
            const briefingInput = document.getElementById('briefing');
            const tokenInput = document.getElementById('token');
            const promptInput = document.getElementById('prompt');
            const passwordInput = document.getElementById('password');
            const generateBtn = document.getElementById('generate-btn');
            const testBtn = document.getElementById('test-btn');
            const downloadBtn = document.getElementById('download-btn');
            const autoTestControls = document.getElementById('auto-test-controls');
            const startAutoTestBtn = document.getElementById('start-auto-test-btn');
            const stopAutoTestBtn = document.getElementById('stop-auto-test-btn');
            const progressContainer = document.getElementById('progress-container');
            const progressBar = document.getElementById('progress-bar');
            const chatContainer = document.getElementById('chat-container');
            const alertArea = document.getElementById('alert-area');
            const extractedTextContainer = document.getElementById('extracted-text-container');
            const extractedTextElement = document.getElementById('extracted-text');
            const downloadSuccess = document.getElementById('download-success');
            const webhookUrlInput = document.getElementById('webhook-url');
            const webhookBiUrlInput = document.getElementById('webhook-bi-url');
            
            // Variáveis de estado
            let chatHistory = [];
            let extractedText = '';
            let generatedPrompt = '';
            let isAutoTesting = false;
            let currentTestIndex = 0;
            const totalTests = 10; // Número fixo de testes
            
            // Event Listeners
            briefingInput.addEventListener('change', handleDocxUpload);
            generateBtn.addEventListener('click', generatePrompt);
            testBtn.addEventListener('click', startTest);
            downloadBtn.addEventListener('click', downloadAgent);
            startAutoTestBtn.addEventListener('click', startAutoTest);
            stopAutoTestBtn.addEventListener('click', stopAutoTest);
            
            // Função para extrair texto do DOCX
            function handleDocxUpload(event) {
                const file = event.target.files[0];
                if (!file) return;
                
                // Verificar se é um arquivo DOCX
                if (!file.name.endsWith('.docx')) {
                    showAlert('Por favor, selecione um arquivo DOCX', 'error');
                    return;
                }
                
                showAlert('Extraindo texto do documento...', 'info');
                
                // Usar Mammoth.js para extrair texto
                const reader = new FileReader();
                reader.onload = function(e) {
                    const arrayBuffer = e.target.result;
                    
                    mammoth.extractRawText({ arrayBuffer: arrayBuffer })
                        .then(function(result) {
                            extractedText = result.value;
                            
                            // Mostrar texto extraído
                            extractedTextElement.textContent = extractedText;
                            extractedTextContainer.classList.remove('hidden');
                            
                            showAlert('Texto extraído com sucesso!', 'success');
                        })
                        .catch(function(error) {
                            console.error('Erro ao extrair texto:', error);
                            showAlert('Erro ao extrair texto do documento', 'error');
                        });
                };
                reader.readAsArrayBuffer(file);
            }
            
            function generatePrompt() {
                // Validação básica
                if (!extractedText && !promptInput.value.trim()) {
                    showAlert('Por favor, forneça um briefing ou um prompt complementar', 'error');
                    return;
                }
                
                if (!tokenInput.value.trim()) {
                    showAlert('O token é obrigatório', 'error');
                    return;
                }
                
                showAlert('Gerando prompt a partir do briefing...', 'info');
                
                // Combinar texto extraído com prompt complementar
                const fullPrompt = extractedText + (promptInput.value.trim() ? '\n\n' + promptInput.value : '');
                
                // Chamar o webhook para gerar o prompt
                fetch('https://api.muvecom.com.br/v1/agente-criador/generate', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        text: fullPrompt,
                        token: tokenInput.value
                    })
                })
                .then(async response => {
                    const responseText = await response.text();
                    
                    if (!responseText.trim()) {
                        throw new Error('Resposta vazia do servidor');
                    }
                    
                    if (!isValidJSON(responseText)) {
                        console.error('Resposta JSON inválida:', responseText);
                        throw new Error('Resposta inválida do servidor');
                    }
                    
                    return JSON.parse(responseText);
                })
                .then(data => {
                    if (data.success) {
                        generatedPrompt = data.generatedPrompt;
                        showAlert('Prompt gerado com sucesso! Agora você pode testar o agente.', 'success');
                        
                        // Habilitar botões de teste e download
                        testBtn.disabled = false;
                        downloadBtn.disabled = false;
                    } else {
                        showAlert('Erro ao gerar prompt: ' + (data.message || 'Erro desconhecido'), 'error');
                    }
                })
                .catch(error => {
                    console.error('Erro:', error);
                    showAlert('Erro ao conectar com o servidor: ' + error.message, 'error');
                });
            }
            
            function startTest() {
                if (!generatedPrompt) {
                    showAlert('Gere um prompt primeiro antes de testar', 'error');
                    return;
                }
                
                // Mostrar a área de teste
                autoTestControls.classList.remove('hidden');
                chatContainer.classList.remove('hidden');
                chatContainer.innerHTML = '';
                
                // Adicionar mensagem inicial
                addMessage('Sistema', 'Pronto para iniciar o teste automático. Clique em "Iniciar Teste Automático" para começar.', 'system');
            }
            
            function startAutoTest() {
                if (!generatedPrompt) return;
                
                currentTestIndex = 0;
                isAutoTesting = true;
                
                // Atualizar UI
                startAutoTestBtn.style.display = 'none';
                stopAutoTestBtn.style.display = 'inline-block';
                progressContainer.classList.remove('hidden');
                updateProgressBar();
                chatContainer.innerHTML = '';
                
                // Gerar perguntas baseadas no briefing/prompt
                const questions = generateTestQuestions();
                
                // Iniciar o processo de teste
                addMessage('Sistema', `Iniciando teste automático com ${totalTests} perguntas...`, 'system');
                processNextTestQuestion(questions, 0);
            }
            
            function stopAutoTest() {
                isAutoTesting = false;
                startAutoTestBtn.style.display = 'inline-block';
                stopAutoTestBtn.style.display = 'none';
                addMessage('Sistema', 'Teste automático interrompido.', 'system');
            }
            
            function processNextTestQuestion(questions, index) {
                if (!isAutoTesting || index >= questions.length) {
                    // Teste finalizado
                    isAutoTesting = false;
                    startAutoTestBtn.style.display = 'inline-block';
                    stopAutoTestBtn.style.display = 'none';
                    addMessage('Sistema', 'Teste automático concluído!', 'system');
                    return;
                }
                
                currentTestIndex = index;
                updateProgressBar();
                
                const question = questions[index];
                addMessage('Testador', question, 'user');
                
                // Mostrar indicador de digitação
                const typingIndicator = showTypingIndicator();
                
                // Enviar pergunta para o webhook de teste
                fetch('https://api.muvecom.com.br/v1/agente-criador/test', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        prompt: generatedPrompt,
                        userMessage: question,
                        token: tokenInput.value
                    })
                })
                .then(async response => {
                    // Remover indicador de digitação
                    removeTypingIndicator(typingIndicator);
                    
                    // Verificar se a resposta está vazia
                    const responseText = await response.text();
                    
                    if (!responseText.trim()) {
                        throw new Error('Resposta vazia do servidor');
                    }
                    
                    // Tentar fazer parsing do JSON
                    try {
                        return JSON.parse(responseText);
                    } catch (e) {
                        console.error('Erro ao parsear JSON:', e, 'Resposta:', responseText);
                        throw new Error('Resposta inválida do servidor: ' + responseText.substring(0, 100));
                    }
                })
                .then(data => {
                    if (data && data.success) {
                        // Exibir tanto a pergunta quanto a resposta
                        addMessage('Agente', data.response, 'ai');
                        
                        // Aguardar um pouco antes da próxima pergunta
                        setTimeout(() => {
                            processNextTestQuestion(questions, index + 1);
                        }, 1000);
                    } else {
                        const errorMsg = data && data.message ? data.message : 'Resposta inválida do servidor';
                        addMessage('Sistema', 'Erro: ' + errorMsg, 'system');
                        setTimeout(() => {
                            processNextTestQuestion(questions, index + 1);
                        }, 1000);
                    }
                })
                .catch(error => {
                    console.error('Erro:', error);
                    removeTypingIndicator(typingIndicator);
                    addMessage('Sistema', 'Erro: ' + error.message, 'system');
                    setTimeout(() => {
                        processNextTestQuestion(questions, index + 1);
                    }, 1000);
                });
            }
            
            function generateTestQuestions() {
                const questions = [];
                
                // Perguntas gerais para todos os cenários
                const generalQuestions = [
                    "Você pode se apresentar?",
                    "Qual é o seu propósito principal?",
                    "Como você pode me ajudar?",
                    "Quais são suas principais funcionalidades?",
                    "Você pode me dar um exemplo de como usar suas capacidades?",
                    "Como devo começar a interagir com você?",
                    "Quais tipos de solicitações você pode atender?",
                    "Existe alguma limitação no que você pode fazer?",
                    "Como você se diferencia de outros assistentes?",
                    "Que tipo de problemas você resolve melhor?"
                ];
                
                // Se temos um briefing, adicionar perguntas específicas
                if (extractedText) {
                    // Usar as primeiras 5 perguntas gerais e 5 específicas
                    questions.push(...generalQuestions.slice(0, 5));
                    
                    // Gerar 5 perguntas específicas baseadas no briefing
                    const specificQuestions = generateQuestionsFromBriefing();
                    questions.push(...specificQuestions.slice(0, 5));
                } else {
                    // Usar apenas perguntas gerais
                    questions.push(...generalQuestions.slice(0, totalTests));
                }
                
                return questions.slice(0, totalTests);
            }
            
            function generateQuestionsFromBriefing() {
                if (!extractedText) return [];
                
                const questions = [];
                const sentences = extractedText.split(/[.!?]+/).filter(s => s.trim().length > 10);
                
                for (let i = 0; i < Math.min(sentences.length, 5); i++) {
                    const sentence = sentences[i].trim();
                    if (sentence.length > 0) {
                        questions.push(`Explique mais sobre: ${sentence}`);
                    }
                }
                
                // Se não temos perguntas suficientes, adicionar algumas genéricas
                while (questions.length < 5) {
                    questions.push("Como isso se relaciona com o contexto fornecido?");
                }
                
                return questions;
            }
            
            function updateProgressBar() {
                const progress = totalTests > 0 ? (currentTestIndex / totalTests) * 100 : 0;
                progressBar.style.width = `${progress}%`;
                progressBar.textContent = `${Math.round(progress)}%`;
            }
            
            function downloadAgent() {
                if (!generatedPrompt) {
                    showAlert('Gere um prompt primeiro antes de baixar', 'error');
                    return;
                }
                
                if (!passwordInput.value.trim()) {
                    showAlert('A senha é obrigatória para baixar o agente', 'error');
                    return;
                }
                
                if (!tokenInput.value.trim()) {
                    showAlert('O token é obrigatório', 'error');
                    return;
                }
                
                showAlert('Baixando agente...', 'info');
                
                // Solicitar download do agente via webhook
                fetch('https://api.muvecom.com.br/v1/agente-criador/download', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        password: passwordInput.value,
                        token: tokenInput.value,
                        prompt: generatedPrompt
                    })
                })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Erro no servidor: ' + response.status);
                    }
                    return response.blob();
                })
                .then(blob => {
                    // Criar um link para download do arquivo
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.style.display = 'none';
                    a.href = url;
                    a.download = 'agente.json';
                    document.body.appendChild(a);
                    a.click();
                    window.URL.revokeObjectURL(url);
                    
                    // Mostrar URLs do webhook
                    const baseUrl = `https://api.muvecom.com.br/v1/${tokenInput.value}`;
                    webhookUrlInput.value = baseUrl;
                    webhookBiUrlInput.value = `${baseUrl}/bi`;
                    downloadSuccess.classList.remove('hidden');
                    
                    showAlert('Agente baixado com sucesso!', 'success');
                })
                .catch(error => {
                    console.error('Erro:', error);
                    showAlert('Erro ao baixar o agente: ' + error.message, 'error');
                });
            }
            
            function addMessage(sender, text, type) {
                const messageElement = document.createElement('div');
                messageElement.classList.add('message');
                
                if (type === 'user') {
                    messageElement.classList.add('user-message');
                } else if (type === 'ai') {
                    messageElement.classList.add('ai-message');
                } else {
                    messageElement.classList.add('system-message');
                }
                
                const senderElement = document.createElement('div');
                senderElement.classList.add('message-sender');
                senderElement.textContent = sender;
                
                const textElement = document.createElement('div');
                textElement.textContent = text;
                
                messageElement.appendChild(senderElement);
                messageElement.appendChild(textElement);
                
                chatContainer.appendChild(messageElement);
                chatContainer.scrollTop = chatContainer.scrollHeight;
                
                // Adicionar ao histórico
                chatHistory.push({ sender, text, type });
            }
            
            function showAlert(message, type) {
                const alert = document.createElement('div');
                alert.classList.add('alert');
                
                if (type === 'error') {
                    alert.classList.add('alert-danger');
                } else if (type === 'success') {
                    alert.classList.add('alert-success');
                } else {
                    alert.classList.add('alert-info');
                }
                
                alert.textContent = message;
                
                alertArea.innerHTML = '';
                alertArea.appendChild(alert);
                
                // Remover alerta após 5 segundos
                setTimeout(() => {
                    alert.remove();
                }, 5000);
            }
            
            function showTypingIndicator() {
                const indicator = document.createElement('div');
                indicator.classList.add('typing-indicator');
                indicator.id = 'typing-indicator';
                
                indicator.innerHTML = `
                    <span class="typing-dot"></span>
                    <span class="typing-dot"></span>
                    <span class="typing-dot"></span>
                `;
                
                chatContainer.appendChild(indicator);
                chatContainer.scrollTop = chatContainer.scrollHeight;
                
                return indicator;
            }
            
            function removeTypingIndicator(indicator) {
                if (indicator && indicator.parentNode) {
                    indicator.parentNode.removeChild(indicator);
                }
            }
            
            function isValidJSON(str) {
                try {
                    JSON.parse(str);
                    return true;
                } catch (e) {
                    return false;
                }
            }
            
            window.copyWebhookUrl = function(elementId) {
                const element = document.getElementById(elementId);
                element.select();
                document.execCommand('copy');
                showAlert('URL copiada para a área de transferência!', 'success');
            };
        });
    </script>
</body>
</html>
